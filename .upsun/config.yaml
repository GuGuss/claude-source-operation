applications:
  app:
    type: php:8.4
    dependencies:
      nodejs:
        '@anthropic-ai/claude-code': '*'
    relationships:
      database: 'postgresql:postgresql'
    hooks:
      build: |
        set -ex
        # Install claude-code package dependencies if needed
        # (Assuming claude-code is a CLI tool installed via Nix package)
        claude --version
    web:
      locations:
        '/':
          root: 'public'
          passthru: '/app.php'
    source:
      operations:
        source-code-operator:
          command: curl -sSL https://gist.github.com/GuGuss/071863b598739f2b885c9b17445d7e34#file-claude-source-operation-sh | bash
routes:
  'https://{default}':
    type: upstream
    upstream: app:http
