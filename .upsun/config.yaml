applications:
  app:
    type: php:8.4
    dependencies:
      nodejs:
        '@anthropic-ai/claude-code': '*'
    relationships:
      database: 'postgresql:postgresql'
    hooks:
      build: |
        set -ex
        # Verify claude-code is installed
        claude --version
    web:
      locations:
        '/':
          root: 'public'
          passthru: '/app.php'
    source:
      operations:
        source-code-operator:
          command: curl -sSL https://gist.githubusercontent.com/GuGuss/071863b598739f2b885c9b17445d7e34/raw/claude-source-operation.sh | bash
services:
  postgresql:
    type: postgresql:16
routes:
  'https://{default}':
    type: upstream
    upstream: app:http
